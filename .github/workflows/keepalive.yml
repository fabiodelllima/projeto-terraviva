name: Keep Services Alive

on:
  schedule:
    - cron: '0 8 * * *'  # Diariamente Ã s 08:00 UTC (05:00 BRT)
  workflow_dispatch:

jobs:
  keepalive:
    runs-on: ubuntu-latest
    steps:
      - name: Ping Supabase Database
        env:
          DATABASE_URL: ${{ secrets.DATABASE_URL }}
        run: |
          echo "[INFO] Pinging Supabase database..."
          psql "$DATABASE_URL" -c "SELECT 1;"
          echo "[OK] Supabase active"

      - name: Ping Render API
        run: |
          echo "[INFO] Pinging Render API..."
          curl -sf --max-time 120 https://terraviva-api-bg8s.onrender.com/api/v1/latest-products/ > /dev/null
          echo "[OK] Render active"
